{"version":3,"file":"ExponentCamera.web.js","sourceRoot":"","sources":["../src/ExponentCamera.web.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { CSSProperties } from 'react';\nimport { findNodeHandle, StyleSheet, View } from 'react-native';\n\nimport { CapturedPicture, NativePropsType, PictureOptions } from './Camera.types';\nimport CameraModule from './CameraModule/CameraModule';\nimport CameraManager from './ExponentCameraManager.web';\n\nexport default class ExponentCamera extends React.Component<NativePropsType> {\n  video?: number | null;\n  camera: CameraModule | null = null;\n\n  state = { type: null };\n  componentWillReceiveProps(nextProps) {\n    this._updateCameraProps(nextProps);\n  }\n\n  _updateCameraProps = async ({\n    type,\n    zoom,\n    pictureSize,\n    flashMode,\n    autoFocus,\n    // focusDepth,\n    whiteBalance,\n  }) => {\n    const { camera } = this;\n    if (camera == null) {\n      return;\n    }\n\n    // TODO: Bacon: Batch process\n    camera.setTypeAsync(type);\n    camera.setPictureSize(pictureSize);\n    camera.setZoomAsync(zoom);\n    camera.setAutoFocusAsync(autoFocus);\n    camera.setWhiteBalanceAsync(whiteBalance);\n    camera.setFlashModeAsync(flashMode);\n    await camera.ensureCameraIsRunningAsync();\n    const actualCameraType = camera.getActualCameraType();\n    if (actualCameraType !== this.state.type) {\n      this.setState({ type: actualCameraType });\n    }\n  };\n\n  getCamera = (): CameraModule => {\n    if (this.camera == null) {\n      throw new Error('Camera is not defined yet!');\n    }\n    return this.camera;\n  };\n\n  getAvailablePictureSizes = async (ratio: string): Promise<string[]> => {\n    const camera = this.getCamera();\n    return camera.getAvailablePictureSizes(ratio);\n  };\n\n  takePicture = async (options: PictureOptions): Promise<CapturedPicture> => {\n    const camera = this.getCamera();\n    return camera.takePicture({\n      ...options,\n      // This will always be defined, the option gets added to a queue in the upper-level. We should replace the original so it isn't called twice.\n      onPictureSaved: this.props.onPictureSaved,\n    });\n  };\n\n  resumePreview = async (): Promise<void> => {\n    const camera = this.getCamera();\n    await camera.resumePreview();\n  };\n\n  pausePreview = (): void => {\n    const camera = this.getCamera();\n    camera.pausePreview();\n  };\n\n  onCameraReady = () => {\n    if (this.props.onCameraReady) {\n      this.props.onCameraReady();\n    }\n  };\n\n  onMountError = error => {\n    if (this.props.onMountError) {\n      this.props.onMountError(error);\n    }\n  };\n\n  _setRef = async ref => {\n    this.video = findNodeHandle(ref);\n    this.camera = new CameraModule(ref);\n    this.camera.onCameraReady = this.onCameraReady;\n    this.camera.onMountError = this.onMountError;\n    this._updateCameraProps(this.props as any);\n  };\n\n  render() {\n    const transform = this.state.type === CameraManager.Type.front ? 'rotateY(180deg)' : 'none';\n    const reactStyle = StyleSheet.flatten(this.props.style);\n    const style: CSSProperties = {\n      ...StyleSheet.absoluteFillObject,\n      width: '100%',\n      height: '100%',\n      objectFit: 'cover',\n      transform,\n    };\n\n    return (\n      <View style={{ flex: 1, alignItems: 'stretch', ...reactStyle }}>\n        <video ref={this._setRef} style={style} autoPlay playsInline />\n        {this.props.children}\n      </View>\n    );\n  }\n}\n"]}